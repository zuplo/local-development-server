var De=Object.defineProperty;var e=(o,n)=>De(o,"name",{value:n,configurable:!0});import{bundle as sr,transpile as ar}from"https://deno.land/x/emit@0.29.0/mod.ts";import{load as cr}from"https://deno.land/std@0.203.0/dotenv/mod.ts";import{createOAuth2Token as fr}from"https://deno.land/x/deno_gcp_admin@0.0.5/auth.ts";import{parse as mr}from"https://deno.land/std@0.203.0/flags/mod.ts";import{Server as pr}from"https://deno.land/std@0.203.0/http/server.ts";import*as gr from"https://deno.land/std@0.203.0/fs/mod.ts";import*as hr from"https://deno.land/std@0.203.0/http/http_status.ts";import*as U from"https://deno.land/std@0.203.0/log/mod.ts";import*as vr from"https://deno.land/std@0.203.0/path/mod.ts";import{assert as _r,assertAlmostEquals as Or,assertArrayIncludes as Er,assertEquals as Lr,assertExists as Sr,assertFalse as Mr,assertInstanceOf as Cr,assertIsError as jr,assertMatch as wr,assertNotEquals as Tr,assertNotMatch as Dr,assertNotStrictEquals as Br,assertObjectMatch as Nr,assertRejects as Pr,assertStrictEquals as Ar,assertStringIncludes as Rr,assertThrows as xr,equal as Fr,fail as Ir,unimplemented as Kr,unreachable as $r}from"https://deno.land/std@0.203.0/assert/mod.ts";import{afterAll as Hr,afterEach as Vr,beforeAll as Wr,beforeEach as Ur,describe as Gr,it as Yr}from"https://deno.land/std@0.203.0/testing/bdd.ts";var Be=Object.getOwnPropertyNames,A=e((o,n)=>e(function(){return n||(0,o[Be(o)[0]])((n={exports:{}}).exports,n),n.exports},"__require"),"__commonJS"),Ne=A({"node_modules/secure-json-parse/index.js"(o,n){"use strict";var s=typeof Buffer<"u",c=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,a=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function i(h,C,E){E==null&&C!==null&&typeof C=="object"&&(E=C,C=void 0),s&&Buffer.isBuffer(h)&&(h=h.toString()),h&&h.charCodeAt(0)===65279&&(h=h.slice(1));let f=JSON.parse(h,C);if(f===null||typeof f!="object")return f;let L=E&&E.protoAction||"error",r=E&&E.constructorAction||"error";if(L==="ignore"&&r==="ignore")return f;if(L!=="ignore"&&r!=="ignore"){if(c.test(h)===!1&&a.test(h)===!1)return f}else if(L!=="ignore"&&r==="ignore"){if(c.test(h)===!1)return f}else if(a.test(h)===!1)return f;return u(f,{protoAction:L,constructorAction:r,safe:E&&E.safe})}e(i,"_parse");function u(h,{protoAction:C="error",constructorAction:E="error",safe:f}={}){let L=[h];for(;L.length;){let r=L;L=[];for(let p of r){if(C!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(f===!0)return null;if(C==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(E!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(f===!0)return null;if(E==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(let g in p){let m=p[g];m&&typeof m=="object"&&L.push(m)}}}return h}e(u,"filter");function l(h,C,E){let f=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(h,C,E)}finally{Error.stackTraceLimit=f}}e(l,"parse");function O(h,C){let E=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(h,C,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=E}}e(O,"safeParse"),n.exports=l,n.exports.default=l,n.exports.parse=l,n.exports.safeParse=O,n.exports.scan=u}}),Oe=A({"lib/utils/is-object.js"(o,n){"use strict";n.exports=s;function s(c){return Object.prototype.toString.apply(c)==="[object Object]"}e(s,"isObject")}}),re=A({"lib/constants.js"(o,n){"use strict";n.exports={DATE_FORMAT:"yyyy-mm-dd HH:MM:ss.l o",DATE_FORMAT_SIMPLE:"HH:MM:ss.l",ERROR_LIKE_KEYS:["err","error"],MESSAGE_KEY:"msg",LEVEL_KEY:"level",LEVEL_LABEL:"levelLabel",TIMESTAMP_KEY:"time",LEVELS:{default:"USERLVL",60:"FATAL",50:"ERROR",40:"WARN",30:"INFO",20:"DEBUG",10:"TRACE"},LEVEL_NAMES:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},LOGGER_KEYS:["pid","hostname","name","level","time","timestamp","caller"]}}}),he=A({"lib/utils/join-lines-with-indentation.js"(o,n){"use strict";n.exports=s;function s({input:c,ident:a="    ",eol:i=`
`}){let u=c.split(/\r?\n/);for(let l=1;l<u.length;l+=1)u[l]=a+u[l];return u.join(i)}e(s,"joinLinesWithIndentation")}}),Pe=A({"node_modules/fast-safe-stringify/index.js"(o,n){n.exports=l,l.default=l,l.stable=E,l.stableStringify=E;var s="[...]",c="[Circular]",a=[],i=[];function u(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}e(u,"defaultOptions");function l(r,p,g,m){typeof m>"u"&&(m=u()),h(r,"",0,[],void 0,0,m);var b;try{i.length===0?b=JSON.stringify(r,p,g):b=JSON.stringify(r,L(p),g)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;a.length!==0;){var _=a.pop();_.length===4?Object.defineProperty(_[0],_[1],_[3]):_[0][_[1]]=_[2]}}return b}e(l,"stringify");function O(r,p,g,m){var b=Object.getOwnPropertyDescriptor(m,g);b.get!==void 0?b.configurable?(Object.defineProperty(m,g,{value:r}),a.push([m,g,p,b])):i.push([p,g,r]):(m[g]=r,a.push([m,g,p]))}e(O,"setReplace");function h(r,p,g,m,b,_,w){_+=1;var M;if(typeof r=="object"&&r!==null){for(M=0;M<m.length;M++)if(m[M]===r){O(c,r,p,b);return}if(typeof w.depthLimit<"u"&&_>w.depthLimit){O(s,r,p,b);return}if(typeof w.edgesLimit<"u"&&g+1>w.edgesLimit){O(s,r,p,b);return}if(m.push(r),Array.isArray(r))for(M=0;M<r.length;M++)h(r[M],M,M,m,r,_,w);else{var d=Object.keys(r);for(M=0;M<d.length;M++){var v=d[M];h(r[v],v,M,m,r,_,w)}}m.pop()}}e(h,"decirc");function C(r,p){return r<p?-1:r>p?1:0}e(C,"compareFunction");function E(r,p,g,m){typeof m>"u"&&(m=u());var b=f(r,"",0,[],void 0,0,m)||r,_;try{i.length===0?_=JSON.stringify(b,p,g):_=JSON.stringify(b,L(p),g)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;a.length!==0;){var w=a.pop();w.length===4?Object.defineProperty(w[0],w[1],w[3]):w[0][w[1]]=w[2]}}return _}e(E,"deterministicStringify");function f(r,p,g,m,b,_,w){_+=1;var M;if(typeof r=="object"&&r!==null){for(M=0;M<m.length;M++)if(m[M]===r){O(c,r,p,b);return}try{if(typeof r.toJSON=="function")return}catch{return}if(typeof w.depthLimit<"u"&&_>w.depthLimit){O(s,r,p,b);return}if(typeof w.edgesLimit<"u"&&g+1>w.edgesLimit){O(s,r,p,b);return}if(m.push(r),Array.isArray(r))for(M=0;M<r.length;M++)f(r[M],M,M,m,r,_,w);else{var d={},v=Object.keys(r).sort(C);for(M=0;M<v.length;M++){var j=v[M];f(r[j],j,M,m,r,_,w),d[j]=r[j]}if(typeof b<"u")a.push([b,p,r]),b[p]=d;else return d}m.pop()}}e(f,"deterministicDecirc");function L(r){return r=typeof r<"u"?r:function(p,g){return g},function(p,g){if(i.length>0)for(var m=0;m<i.length;m++){var b=i[m];if(b[1]===p&&b[0]===g){g=b[2],i.splice(m,1);break}}return r.call(this,p,g)}}e(L,"replaceGetterValues")}}),Ae=A({"lib/utils/prettify-error.js"(o,n){"use strict";n.exports=c;var s=he();function c({keyName:a,lines:i,eol:u,ident:l}){let O="",h=s({input:i,ident:l,eol:u}),C=`${l}${a}: ${h}${u}`.split(u);for(let E=0;E<C.length;E+=1){E!==0&&(O+=u);let f=C[E];if(/^\s*"stack"/.test(f)){let L=/^(\s*"stack":)\s*(".*"),?$/.exec(f);if(L&&L.length===3){let r=/^\s*/.exec(f)[0].length+4,p=" ".repeat(r),g=L[2];O+=L[1]+u+p+JSON.parse(g).replace(/\n/g,u+p)}else O+=f}else O+=f}return O}e(c,"prettifyError")}}),Ee=A({"lib/utils/prettify-object.js"(o,n){"use strict";n.exports=u;var{LOGGER_KEYS:s}=re(),c=Pe(),a=he(),i=Ae();function u({log:l,excludeLoggerKeys:O=!0,skipKeys:h=[],context:C}){let{EOL:E,IDENT:f,customPrettifiers:L,errorLikeObjectKeys:r,objectColorizer:p,singleLine:g}=C,m=[].concat(h);O===!0&&Array.prototype.push.apply(m,s);let b="",{plain:_,errors:w}=Object.entries(l).reduce(({plain:M,errors:d},[v,j])=>{if(m.includes(v)===!1){let T=typeof L[v]=="function"?L[v](j,v,l):j;r.includes(v)?d[v]=T:M[v]=T}return{plain:M,errors:d}},{plain:{},errors:{}});return g?(Object.keys(_).length>0&&(b+=p.greyMessage(c(_))),b+=E,b=b.replace(/\\\\/gi,"\\")):Object.entries(_).forEach(([M,d])=>{let v=typeof L[M]=="function"?d:c(d,null,2);if(v===void 0)return;v=v.replace(/\\\\/gi,"\\");let j=a({input:v,ident:f,eol:E});b+=`${f}${M}:${j.startsWith(E)?"":" "}${j}${E}`}),Object.entries(w).forEach(([M,d])=>{let v=typeof L[M]=="function"?d:c(d,null,2);v!==void 0&&(b+=i({keyName:M,lines:v,eol:E,ident:f}))}),b}e(u,"prettifyObject")}}),Re=A({"lib/utils/prettify-error-log.js"(o,n){"use strict";n.exports=u;var{LOGGER_KEYS:s}=re(),c=Oe(),a=he(),i=Ee();function u({log:l,context:O}){let{EOL:h,IDENT:C,errorProps:E,messageKey:f}=O,L=l.stack,r=a({input:L,ident:C,eol:h}),p=`${C}${r}${h}`;if(E.length>0){let g=s.concat(f,"type","stack"),m;E[0]==="*"?m=Object.keys(l).filter(b=>g.includes(b)===!1):m=E.filter(b=>g.includes(b)===!1);for(let b=0;b<m.length;b+=1){let _=m[b];if(_ in l){if(c(l[_])){let w=i({log:l[_],excludeLoggerKeys:!1,context:{...O,IDENT:C+C}});p=`${p}${C}${_}: {${h}${w}${C}}${h}`;continue}p=`${p}${C}${_}: ${l[_]}${h}`}}}return p}e(u,"prettifyErrorLog")}}),Le=A({"lib/utils/split-property-key.js"(o,n){"use strict";n.exports=s;function s(c){let a=[],i=!1,u="";for(let l=0;l<c.length;l++){let O=c.charAt(l);if(O==="\\"){i=!0;continue}if(i){i=!1,u+=O;continue}if(O==="."){a.push(u),u="";continue}u+=O}return u.length&&a.push(u),a}e(s,"splitPropertyKey")}}),se=A({"lib/utils/get-property-value.js"(o,n){"use strict";n.exports=c;var s=Le();function c(a,i){let u=Array.isArray(i)?i:s(i);for(let l of u){if(!Object.prototype.hasOwnProperty.call(a,l))return;a=a[l]}return a}e(c,"getPropertyValue")}}),xe=A({"lib/utils/prettify-level.js"(o,n){"use strict";n.exports=c;var s=se();function c({log:a,context:i}){let{colorizer:u,customLevels:l,customLevelNames:O,levelKey:h}=i,C=i.customPrettifiers?.level,E=s(a,h);if(E!==void 0)return C?C(E):u(E,{customLevels:l,customLevelNames:O})}e(c,"prettifyLevel")}}),Fe=A({"lib/utils/interpret-conditionals.js"(o,n){"use strict";n.exports=c;var s=se();function c(a,i){return a=a.replace(/{if (.*?)}(.*?){end}/g,u),a=a.replace(/{if (.*?)}/g,""),a=a.replace(/{end}/g,""),a.replace(/\s+/g," ").trim();function u(l,O,h){let C=s(i,O);return C&&h.includes(O)?h.replace(new RegExp("{"+O+"}","g"),C):""}e(u,"replacer")}e(c,"interpretConditionals")}}),Ie=A({"lib/utils/prettify-message.js"(o,n){"use strict";n.exports=i;var{LEVELS:s}=re(),c=se(),a=Fe();function i({log:u,context:l}){let{colorizer:O,customLevels:h,levelKey:C,levelLabel:E,messageFormat:f,messageKey:L,useOnlyCustomProps:r}=l;if(f&&typeof f=="string"){let p=a(f,u),g=String(p).replace(/{([^{}]+)}/g,function(m,b){let _;return b===E&&(_=c(u,C))!==void 0?(r?h===void 0:h[_]===void 0)?s[_]:h[_]:c(u,b)||""});return O.message(g)}if(f&&typeof f=="function"){let p=f(u,L,E);return O.message(p)}if(L in u&&!(typeof u[L]!="string"&&typeof u[L]!="number"&&typeof u[L]!="boolean"))return O.message(u[L])}e(i,"prettifyMessage")}}),Ke=A({"lib/utils/prettify-metadata.js"(o,n){"use strict";n.exports=s;function s({log:c,context:a}){let i=a.customPrettifiers,u="";if(c.name||c.pid||c.hostname){if(u+="(",c.name&&(u+=i.name?i.name(c.name):c.name),c.pid){let l=i.pid?i.pid(c.pid):c.pid;c.name&&c.pid?u+="/"+l:u+=l}c.hostname&&(u+=`${u==="("?"on":" on"} ${i.hostname?i.hostname(c.hostname):c.hostname}`),u+=")"}if(c.caller&&(u+=`${u===""?"":" "}<${i.caller?i.caller(c.caller):c.caller}>`),u!=="")return u}e(s,"prettifyMetadata")}}),$e=A({"node_modules/dateformat/lib/dateformat.js"(o,n){"use strict";function s(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=e(function(i){return typeof i},"_typeof2"):s=e(function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},"_typeof2"),s(c)}e(s,"_typeof"),function(c){var a=arguments,i=function(){var E=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,f=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,L=/[^-+\dA-Z]/g;return function(r,p,g,m){if(a.length===1&&C(r)==="string"&&!/\d/.test(r)&&(p=r,r=void 0),r=r||r===0?r:new Date,r instanceof Date||(r=new Date(r)),isNaN(r))throw TypeError("Invalid date");p=String(i.masks[p]||p||i.masks.default);var b=p.slice(0,4);(b==="UTC:"||b==="GMT:")&&(p=p.slice(4),g=!0,b==="GMT:"&&(m=!0));var _=e(function(){return g?"getUTC":"get"},"_2"),w=e(function(){return r[_()+"Date"]()},"d"),M=e(function(){return r[_()+"Day"]()},"D2"),d=e(function(){return r[_()+"Month"]()},"m"),v=e(function(){return r[_()+"FullYear"]()},"y2"),j=e(function(){return r[_()+"Hours"]()},"H"),T=e(function(){return r[_()+"Minutes"]()},"M"),x=e(function(){return r[_()+"Seconds"]()},"s"),F=e(function(){return r[_()+"Milliseconds"]()},"L"),I=e(function(){return g?0:r.getTimezoneOffset()},"o"),K=e(function(){return O(r)},"W"),q=e(function(){return h(r)},"N"),V={d:e(function(){return w()},"d"),dd:e(function(){return u(w())},"dd"),ddd:e(function(){return i.i18n.dayNames[M()]},"ddd"),DDD:e(function(){return l({y:v(),m:d(),d:w(),_:_(),dayName:i.i18n.dayNames[M()],short:!0})},"DDD"),dddd:e(function(){return i.i18n.dayNames[M()+7]},"dddd"),DDDD:e(function(){return l({y:v(),m:d(),d:w(),_:_(),dayName:i.i18n.dayNames[M()+7]})},"DDDD"),m:e(function(){return d()+1},"m"),mm:e(function(){return u(d()+1)},"mm"),mmm:e(function(){return i.i18n.monthNames[d()]},"mmm"),mmmm:e(function(){return i.i18n.monthNames[d()+12]},"mmmm"),yy:e(function(){return String(v()).slice(2)},"yy"),yyyy:e(function(){return u(v(),4)},"yyyy"),h:e(function(){return j()%12||12},"h"),hh:e(function(){return u(j()%12||12)},"hh"),H:e(function(){return j()},"H"),HH:e(function(){return u(j())},"HH"),M:e(function(){return T()},"M"),MM:e(function(){return u(T())},"MM"),s:e(function(){return x()},"s"),ss:e(function(){return u(x())},"ss"),l:e(function(){return u(F(),3)},"l"),L:e(function(){return u(Math.floor(F()/10))},"L"),t:e(function(){return j()<12?i.i18n.timeNames[0]:i.i18n.timeNames[1]},"t"),tt:e(function(){return j()<12?i.i18n.timeNames[2]:i.i18n.timeNames[3]},"tt"),T:e(function(){return j()<12?i.i18n.timeNames[4]:i.i18n.timeNames[5]},"T"),TT:e(function(){return j()<12?i.i18n.timeNames[6]:i.i18n.timeNames[7]},"TT"),Z:e(function(){return m?"GMT":g?"UTC":(String(r).match(f)||[""]).pop().replace(L,"").replace(/GMT\+0000/g,"UTC")},"Z"),o:e(function(){return(I()>0?"-":"+")+u(Math.floor(Math.abs(I())/60)*100+Math.abs(I())%60,4)},"o"),p:e(function(){return(I()>0?"-":"+")+u(Math.floor(Math.abs(I())/60),2)+":"+u(Math.floor(Math.abs(I())%60),2)},"p"),S:e(function(){return["th","st","nd","rd"][w()%10>3?0:(w()%100-w()%10!=10)*w()%10]},"S"),W:e(function(){return K()},"W"),WW:e(function(){return u(K())},"WW"),N:e(function(){return q()},"N")};return p.replace(E,function(S){return S in V?V[S]():S.slice(1,S.length-1)})}}();i.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},i.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]};var u=e(function(f,L){for(f=String(f),L=L||2;f.length<L;)f="0"+f;return f},"pad2"),l=e(function(f){var L=f.y,r=f.m,p=f.d,g=f._,m=f.dayName,b=f.short,_=b===void 0?!1:b,w=new Date,M=new Date;M.setDate(M[g+"Date"]()-1);var d=new Date;d.setDate(d[g+"Date"]()+1);var v=e(function(){return w[g+"Date"]()},"today_d2"),j=e(function(){return w[g+"Month"]()},"today_m2"),T=e(function(){return w[g+"FullYear"]()},"today_y2"),x=e(function(){return M[g+"Date"]()},"yesterday_d2"),F=e(function(){return M[g+"Month"]()},"yesterday_m2"),I=e(function(){return M[g+"FullYear"]()},"yesterday_y2"),K=e(function(){return d[g+"Date"]()},"tomorrow_d2"),q=e(function(){return d[g+"Month"]()},"tomorrow_m2"),V=e(function(){return d[g+"FullYear"]()},"tomorrow_y2");return T()===L&&j()===r&&v()===p?_?"Tdy":"Today":I()===L&&F()===r&&x()===p?_?"Ysd":"Yesterday":V()===L&&q()===r&&K()===p?_?"Tmw":"Tomorrow":m},"getDayName2"),O=e(function(f){var L=new Date(f.getFullYear(),f.getMonth(),f.getDate());L.setDate(L.getDate()-(L.getDay()+6)%7+3);var r=new Date(L.getFullYear(),0,4);r.setDate(r.getDate()-(r.getDay()+6)%7+3);var p=L.getTimezoneOffset()-r.getTimezoneOffset();L.setHours(L.getHours()-p);var g=(L-r)/(864e5*7);return 1+Math.floor(g)},"getWeek2"),h=e(function(f){var L=f.getDay();return L===0&&(L=7),L},"getDayOfWeek2"),C=e(function(f){return f===null?"null":f===void 0?"undefined":s(f)!=="object"?s(f):Array.isArray(f)?"array":{}.toString.call(f).slice(8,-1).toLowerCase()},"kindOf2");typeof define=="function"&&define.amd?define(function(){return i}):(typeof o>"u"?"undefined":s(o))==="object"?n.exports=i:c.dateFormat=i}(void 0)}}),Se=A({"lib/utils/is-valid-date.js"(o,n){"use strict";n.exports=s;function s(c){return c instanceof Date&&!Number.isNaN(c.getTime())}e(s,"isValidDate")}}),qe=A({"lib/utils/create-date.js"(o,n){"use strict";n.exports=c;var s=Se();function c(a){let i=new Date(a);return s(i)||(i=new Date(+a)),i}e(c,"createDate")}}),He=A({"lib/utils/format-time.js"(o,n){"use strict";n.exports=l;var{DATE_FORMAT:s,DATE_FORMAT_SIMPLE:c}=re(),a=$e(),i=qe(),u=Se();function l(O,h=!1){if(h===!1)return O;let C=i(O);if(!u(C))return O;if(h===!0)return a(C,c);let E=h.toUpperCase();if(E==="SYS:STANDARD")return a(C,s);let f=E.substr(0,4);return f==="SYS:"||f==="UTC:"?f==="UTC:"?a(C,h):a(C,h.slice(4)):a(C,`UTC:${h}`)}e(l,"formatTime")}}),Ve=A({"lib/utils/prettify-time.js"(o,n){"use strict";n.exports=c;var s=He();function c({log:a,context:i}){let{timestampKey:u,translateTime:l}=i,O=i.customPrettifiers?.time,h=null;if(u in a?h=a[u]:"timestamp"in a&&(h=a.timestamp),h===null)return;let C=l?s(h,l):h;return O?O(C):`[${C}]`}e(c,"prettifyTime")}}),We=A({"node_modules/fast-copy/dist/cjs/index.cjs"(o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=Function.prototype.toString,s=Object.create,c=Object.prototype.toString,a=function(){function t(){this._keys=[],this._values=[]}return e(t,"LegacyCache2"),t.prototype.has=function(y){return!!~this._keys.indexOf(y)},t.prototype.get=function(y){return this._values[this._keys.indexOf(y)]},t.prototype.set=function(y,D){this._keys.push(y),this._values.push(D)},t}();function i(){return new a}e(i,"createCacheLegacy");function u(){return new WeakMap}e(u,"createCacheModern");var l=typeof WeakMap<"u"?u:i;function O(t){if(!t)return s(null);var y=t.constructor;if(y===Object)return t===Object.prototype?{}:s(t);if(~n.call(y).indexOf("[native code]"))try{return new y}catch{}return s(t)}e(O,"getCleanClone");function h(t){var y="";return t.global&&(y+="g"),t.ignoreCase&&(y+="i"),t.multiline&&(y+="m"),t.unicode&&(y+="u"),t.sticky&&(y+="y"),y}e(h,"getRegExpFlagsLegacy");function C(t){return t.flags}e(C,"getRegExpFlagsModern");var E=/test/g.flags==="g"?C:h;function f(t){var y=c.call(t);return y.substring(8,y.length-1)}e(f,"getTagLegacy");function L(t){return t[Symbol.toStringTag]||f(t)}e(L,"getTagModern");var r=typeof Symbol<"u"?L:f,p=Object.defineProperty,g=Object.getOwnPropertyDescriptor,m=Object.getOwnPropertyNames,b=Object.getOwnPropertySymbols,_=Object.prototype,w=_.hasOwnProperty,M=_.propertyIsEnumerable,d=typeof b=="function";function v(t){return m(t).concat(b(t))}e(v,"getStrictPropertiesModern");var j=d?v:m;function T(t,y,D){for(var P=j(t),$=0,R=P.length,N=void 0,B=void 0;$<R;++$)if(N=P[$],!(N==="callee"||N==="caller")){if(B=g(t,N),!B){y[N]=D.copier(t[N],D);continue}!B.get&&!B.set&&(B.value=D.copier(B.value,D));try{p(y,N,B)}catch{y[N]=B.value}}return y}e(T,"copyOwnPropertiesStrict");function x(t,y){var D=new y.Constructor;y.cache.set(t,D);for(var P=0,$=t.length;P<$;++P)D[P]=y.copier(t[P],y);return D}e(x,"copyArrayLoose");function F(t,y){var D=new y.Constructor;return y.cache.set(t,D),T(t,D,y)}e(F,"copyArrayStrict");function I(t,y){return t.slice(0)}e(I,"copyArrayBuffer");function K(t,y){return t.slice(0,t.size,t.type)}e(K,"copyBlob");function q(t,y){return new y.Constructor(I(t.buffer))}e(q,"copyDataView");function V(t,y){return new y.Constructor(t.getTime())}e(V,"copyDate");function S(t,y){var D=new y.Constructor;return y.cache.set(t,D),t.forEach(function(P,$){D.set($,y.copier(P,y))}),D}e(S,"copyMapLoose");function Z(t,y){return T(t,S(t,y),y)}e(Z,"copyMapStrict");function G(t,y){var D=O(y.prototype);y.cache.set(t,D);for(var P in t)w.call(t,P)&&(D[P]=y.copier(t[P],y));return D}e(G,"copyObjectLooseLegacy");function X(t,y){var D=O(y.prototype);y.cache.set(t,D);for(var P in t)w.call(t,P)&&(D[P]=y.copier(t[P],y));for(var $=b(t),R=0,N=$.length,B=void 0;R<N;++R)B=$[R],M.call(t,B)&&(D[B]=y.copier(t[B],y));return D}e(X,"copyObjectLooseModern");var te=d?X:G;function z(t,y){var D=O(y.prototype);return y.cache.set(t,D),T(t,D,y)}e(z,"copyObjectStrict");function Y(t,y){return new y.Constructor(t.valueOf())}e(Y,"copyPrimitiveWrapper");function ue(t,y){var D=new y.Constructor(t.source,E(t));return D.lastIndex=t.lastIndex,D}e(ue,"copyRegExp");function k(t,y){return t}e(k,"copySelf");function ne(t,y){var D=new y.Constructor;return y.cache.set(t,D),t.forEach(function(P){D.add(y.copier(P,y))}),D}e(ne,"copySetLoose");function ce(t,y){return T(t,ne(t,y),y)}e(ce,"copySetStrict");var le=Array.isArray,Q=Object.assign,fe=Object.getPrototypeOf||function(t){return t.__proto__},ie={array:x,arrayBuffer:I,blob:K,dataView:q,date:V,error:k,map:S,object:te,regExp:ue,set:ne},ye=Q({},ie,{array:F,map:Z,object:z,set:ce});function me(t){return{Arguments:t.object,Array:t.array,ArrayBuffer:t.arrayBuffer,Blob:t.blob,Boolean:Y,DataView:t.dataView,Date:t.date,Error:t.error,Float32Array:t.arrayBuffer,Float64Array:t.arrayBuffer,Int8Array:t.arrayBuffer,Int16Array:t.arrayBuffer,Int32Array:t.arrayBuffer,Map:t.map,Number:Y,Object:t.object,Promise:k,RegExp:t.regExp,Set:t.set,String:Y,WeakMap:k,WeakSet:k,Uint8Array:t.arrayBuffer,Uint8ClampedArray:t.arrayBuffer,Uint16Array:t.arrayBuffer,Uint32Array:t.arrayBuffer,Uint64Array:t.arrayBuffer}}e(me,"getTagSpecificCopiers");function ee(t){var y=Q({},ie,t),D=me(y),P=D.Array,$=D.Object;function R(N,B){if(B.prototype=B.Constructor=void 0,!N||typeof N!="object")return N;if(B.cache.has(N))return B.cache.get(N);if(B.prototype=fe(N),B.Constructor=B.prototype&&B.prototype.constructor,!B.Constructor||B.Constructor===Object)return $(N,B);if(le(N))return P(N,B);var H=D[r(N)];return H?H(N,B):typeof N.then=="function"?N:$(N,B)}return e(R,"copier"),e(function(B){return R(B,{Constructor:void 0,cache:l(),copier:R,prototype:void 0})},"copy")}e(ee,"createCopier");function oe(t){return ee(Q({},ye,t))}e(oe,"createStrictCopier");var de=oe({}),pe=ee({});o.copyStrict=de,o.createCopier=ee,o.createStrictCopier=oe,o.default=pe}}),Ue=A({"lib/utils/delete-log-property.js"(o,n){"use strict";n.exports=a;var s=se(),c=Le();function a(i,u){let l=c(u),O=l.pop();i=s(i,l),i!==null&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,O)&&delete i[O]}e(a,"deleteLogProperty")}}),Ge=A({"lib/utils/filter-log.js"(o,n){"use strict";n.exports=i;var{createCopier:s}=We(),c=s({}),a=Ue();function i({log:u,context:l}){let{ignoreKeys:O,includeKeys:h}=l,C=c(u);if(h){let E={};return h.forEach(f=>{E[f]=C[f]}),E}return O.forEach(E=>{a(C,E)}),C}e(i,"filterLog")}}),Ye=A({"lib/pretty.js"(o,n){n.exports=p;var s=Ne(),c=Oe(),a=Re(),i=xe(),u=Ie(),l=Ke(),O=Ee(),h=Ve(),C=Ge(),{LEVELS:E,LEVEL_KEY:f,LEVEL_NAMES:L}=re(),r=e(g=>{try{return{value:s.parse(g,{protoAction:"remove"})}}catch(m){return{err:m}}},"jsonParser");function p(g){let m;if(c(g))m=g;else{let v=r(g);if(v.err||!c(v.value))return g+this.EOL;m=v.value}if(this.minimumLevel){let v;this.useOnlyCustomProps?v=this.customLevels:v=this.customLevelNames[this.minimumLevel]!==void 0;let j;if(v?j=this.customLevelNames[this.minimumLevel]:j=L[this.minimumLevel],j||(j=typeof this.minimumLevel=="string"?L[this.minimumLevel]:L[E[this.minimumLevel].toLowerCase()]),m[this.levelKey===void 0?f:this.levelKey]<j)return}let b=u({log:m,context:this.context});(this.ignoreKeys||this.includeKeys)&&(m=C({log:m,context:this.context}));let _=i({log:m,context:{...this.context,...this.context.customProperties}}),w=l({log:m,context:this.context}),M=h({log:m,context:this.context}),d="";if(this.levelFirst&&_&&(d=`${_}`),M&&d===""?d=`${M}`:M&&(d=`${d} ${M}`),!this.levelFirst&&_&&(d.length>0?d=`${d} ${_}`:d=_),w&&(d.length>0?d=`${d} ${w}:`:d=w),d.endsWith(":")===!1&&d!==""&&(d+=":"),b!==void 0&&(d.length>0?d=`${d} ${b}`:d=b),d.length>0&&!this.singleLine&&(d+=this.EOL),m.type==="Error"&&m.stack){let v=a({log:m,context:this.context});this.singleLine&&(d+=this.EOL),d+=v}else if(this.hideObject===!1){let v=[this.messageKey,this.levelKey,this.timestampKey].filter(T=>typeof m[T]=="string"||typeof m[T]=="number"||typeof m[T]=="boolean"),j=O({log:m,skipKeys:v,context:this.context});this.singleLine&&!/^\s$/.test(j)&&(d+=" "),d+=j}return d}e(p,"pretty")}}),Me=Ye();var ze=Object.getOwnPropertyNames;var J=e((o,n)=>e(function(){return n||(0,o[ze(o)[0]])((n={exports:{}}).exports,n),n.exports},"__require2"),"__commonJS"),Ce=J({"lib/constants.js"(o,n){"use strict";n.exports={DATE_FORMAT:"yyyy-mm-dd HH:MM:ss.l o",DATE_FORMAT_SIMPLE:"HH:MM:ss.l",ERROR_LIKE_KEYS:["err","error"],MESSAGE_KEY:"msg",LEVEL_KEY:"level",LEVEL_LABEL:"levelLabel",TIMESTAMP_KEY:"time",LEVELS:{default:"USERLVL",60:"FATAL",50:"ERROR",40:"WARN",30:"INFO",20:"DEBUG",10:"TRACE"},LEVEL_NAMES:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},LOGGER_KEYS:["pid","hostname","name","level","time","timestamp","caller"]}}}),ke=J({"node_modules/colorette/index.cjs"(o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var{env:n={},argv:s=[],platform:c=""}=typeof process>"u"?{}:process,a="NO_COLOR"in n||s.includes("--no-color"),i="FORCE_COLOR"in n||s.includes("--color"),u=c==="win32",l=n.TERM==="dumb",O=globalThis.Deno&&globalThis.Deno.isatty(1)&&n.TERM&&!l,h="CI"in n&&("GITHUB_ACTIONS"in n||"GITLAB_CI"in n||"CIRCLECI"in n),C=!a&&(i||u&&!l||O||h),E=e((R,N,B,H,W=N.substring(0,R)+H,ge=N.substring(R+B.length),_e=ge.indexOf(B))=>W+(_e<0?ge:E(_e,ge,B,H)),"replaceClose"),f=e((R,N,B,H,W)=>R<0?B+N+H:B+E(R,N,H,W)+H,"clearBleed"),L=e((R,N,B=R,H=R.length+1)=>W=>W||!(W===""||W===void 0)?f((""+W).indexOf(N,H),W,R,N,B):"","filterEmpty"),r=e((R,N,B)=>L(`\x1B[${R}m`,`\x1B[${N}m`,B),"init"),p={reset:r(0,0),bold:r(1,22,"\x1B[22m\x1B[1m"),dim:r(2,22,"\x1B[22m\x1B[2m"),italic:r(3,23),underline:r(4,24),inverse:r(7,27),hidden:r(8,28),strikethrough:r(9,29),black:r(30,39),red:r(31,39),green:r(32,39),yellow:r(33,39),blue:r(34,39),magenta:r(35,39),cyan:r(36,39),white:r(37,39),gray:r(90,39),bgBlack:r(40,49),bgRed:r(41,49),bgGreen:r(42,49),bgYellow:r(43,49),bgBlue:r(44,49),bgMagenta:r(45,49),bgCyan:r(46,49),bgWhite:r(47,49),blackBright:r(90,39),redBright:r(91,39),greenBright:r(92,39),yellowBright:r(93,39),blueBright:r(94,39),magentaBright:r(95,39),cyanBright:r(96,39),whiteBright:r(97,39),bgBlackBright:r(100,49),bgRedBright:r(101,49),bgGreenBright:r(102,49),bgYellowBright:r(103,49),bgBlueBright:r(104,49),bgMagentaBright:r(105,49),bgCyanBright:r(106,49),bgWhiteBright:r(107,49)},g=e(({useColor:R=C}={})=>R?p:Object.keys(p).reduce((N,B)=>({...N,[B]:String}),{}),"createColors"),{reset:m,bold:b,dim:_,italic:w,underline:M,inverse:d,hidden:v,strikethrough:j,black:T,red:x,green:F,yellow:I,blue:K,magenta:q,cyan:V,white:S,gray:Z,bgBlack:G,bgRed:X,bgGreen:te,bgYellow:z,bgBlue:Y,bgMagenta:ue,bgCyan:k,bgWhite:ne,blackBright:ce,redBright:le,greenBright:Q,yellowBright:fe,blueBright:ie,magentaBright:ye,cyanBright:me,whiteBright:ee,bgBlackBright:oe,bgRedBright:de,bgGreenBright:pe,bgYellowBright:t,bgBlueBright:y,bgMagentaBright:D,bgCyanBright:P,bgWhiteBright:$}=g();o.bgBlack=G,o.bgBlackBright=oe,o.bgBlue=Y,o.bgBlueBright=y,o.bgCyan=k,o.bgCyanBright=P,o.bgGreen=te,o.bgGreenBright=pe,o.bgMagenta=ue,o.bgMagentaBright=D,o.bgRed=X,o.bgRedBright=de,o.bgWhite=ne,o.bgWhiteBright=$,o.bgYellow=z,o.bgYellowBright=t,o.black=T,o.blackBright=ce,o.blue=K,o.blueBright=ie,o.bold=b,o.createColors=g,o.cyan=V,o.cyanBright=me,o.dim=_,o.gray=Z,o.green=F,o.greenBright=Q,o.hidden=v,o.inverse=d,o.isColorSupported=C,o.italic=w,o.magenta=q,o.magentaBright=ye,o.red=x,o.redBright=le,o.reset=m,o.strikethrough=j,o.underline=M,o.white=S,o.whiteBright=ee,o.yellow=I,o.yellowBright=fe}}),Je=J({"lib/colors.js"(o,n){"use strict";var{LEVELS:s,LEVEL_NAMES:c}=Ce(),a=e(d=>d,"nocolor"),i={default:a,60:a,50:a,40:a,30:a,20:a,10:a,message:a,greyMessage:a},{createColors:u}=ke(),l=u({useColor:!0}),{white:O,bgRed:h,red:C,yellow:E,green:f,blue:L,gray:r,cyan:p}=l,g={default:O,60:h,50:C,40:E,30:f,20:L,10:r,message:p,greyMessage:r};function m(d){return d.reduce(function(v,[j,T]){return v[j]=typeof l[T]=="function"?l[T]:O,v},{default:O,message:p,greyMessage:r})}e(m,"resolveCustomColoredColorizer");function b(d){return function(v,j,{customLevels:T,customLevelNames:x}={}){let F=d?T||s:Object.assign({},s,T),I=d?x||c:Object.assign({},c,x),K="default";Number.isInteger(+v)?K=Object.prototype.hasOwnProperty.call(F,v)?v:K:K=Object.prototype.hasOwnProperty.call(I,v.toLowerCase())?I[v.toLowerCase()]:K;let q=F[K];return Object.prototype.hasOwnProperty.call(j,K)?j[K](q):j.default(q)}}e(b,"colorizeLevel");function _(d){let v=b(d),j=e(function(T,x){return v(T,i,x)},"customColoredColorizer");return j.message=i.message,j.greyMessage=i.greyMessage,j}e(_,"plainColorizer");function w(d){let v=b(d),j=e(function(T,x){return v(T,g,x)},"customColoredColorizer");return j.message=g.message,j.greyMessage=g.greyMessage,j}e(w,"coloredColorizer");function M(d,v){let j=m(d),T=v?j:Object.assign({},g,j),x=b(v),F=e(function(I,K){return x(I,T,K)},"customColoredColorizer");return F.message=F.message||T.message,F.greyMessage=F.greyMessage||T.greyMessage,F}e(M,"customColoredColorizerFactory"),n.exports=e(function(v=!1,j,T){return v&&j!==void 0?M(j,T):v?w(T):_(T)},"getColorizer")}}),Ze=J({"lib/utils/handle-custom-levels-opts.js"(o,n){"use strict";n.exports=s;function s(c){return c?typeof c=="string"?c.split(",").reduce((a,i,u)=>{let[l,O=u]=i.split(":");return a[O]=l.toUpperCase(),a},{default:"USERLVL"}):Object.prototype.toString.call(c)==="[object Object]"?Object.keys(c).reduce((a,i)=>(a[c[i]]=i.toUpperCase(),a),{default:"USERLVL"}):{}:{}}e(s,"handleCustomLevelsOpts")}}),Xe=J({"lib/utils/handle-custom-levels-names-opts.js"(o,n){"use strict";n.exports=s;function s(c){return c?typeof c=="string"?c.split(",").reduce((a,i,u)=>{let[l,O=u]=i.split(":");return a[l.toLowerCase()]=O,a},{}):Object.prototype.toString.call(c)==="[object Object]"?Object.keys(c).reduce((a,i)=>(a[i.toLowerCase()]=c[i],a),{}):{}:{}}e(s,"handleCustomLevelsNamesOpts")}}),Qe=J({"lib/utils/parse-factory-options.js"(o,n){n.exports=u;var{LEVEL_NAMES:s}=Ce(),c=Je(),a=Ze(),i=Xe();function u(l){let O=l.crlf?`\r
`:`
`,h="    ",{customPrettifiers:C,errorLikeObjectKeys:E,hideObject:f,levelFirst:L,levelKey:r,levelLabel:p,messageFormat:g,messageKey:m,minimumLevel:b,singleLine:_,timestampKey:w,translateTime:M}=l,d=l.errorProps.split(","),v=typeof l.useOnlyCustomProps=="boolean"?l.useOnlyCustomProps:l.useOnlyCustomProps==="true",j=a(l.customLevels),T=i(l.customLevels),x;l.customColors&&(x=l.customColors.split(",").reduce((S,Z)=>{let[G,X]=Z.split(":"),z=(v?l.customLevels:T[G]!==void 0)?T[G]:s[G],Y=z!==void 0?z:G;return S.push([Y,X]),S},[]));let F={customLevels:j,customLevelNames:T};v===!0&&!l.customLevels&&(F.customLevels=void 0,F.customLevelNames=void 0);let I=l.include!==void 0?new Set(l.include.split(",")):void 0,K=!I&&l.ignore?new Set(l.ignore.split(",")):void 0,q=c(l.colorize,x,v),V=l.colorizeObjects?q:c(!1,[],!1);return{EOL:O,IDENT:h,colorizer:q,customColors:x,customLevelNames:T,customLevels:j,customPrettifiers:C,customProperties:F,errorLikeObjectKeys:E,errorProps:d,hideObject:f,ignoreKeys:K,includeKeys:I,levelFirst:L,levelKey:r,levelLabel:p,messageFormat:g,messageKey:m,minimumLevel:b,objectColorizer:V,singleLine:_,timestampKey:w,translateTime:M,useOnlyCustomProps:v}}e(u,"parseFactoryOptions")}}),je=Qe();var er={colorize:!0,colorizeObjects:!0,crlf:!1,customColors:null,customLevels:null,customPrettifiers:{},errorLikeObjectKeys:["err","error"],errorProps:"",hideObject:!1,ignore:"hostname",include:void 0,levelFirst:!1,levelKey:"level",levelLabel:"levelLabel",messageFormat:null,messageKey:"msg",minimumLevel:void 0,outputStream:console,singleLine:!1,timestampKey:"timestamp",translateTime:"SYS:HH:MM:ss",useOnlyCustomProps:!0};function rr(o){let n=je(Object.assign({},er,o));return Me.bind({...n,context:n})}e(rr,"prettyFactory");var we=rr({customPrettifiers:{time:o=>`${o}`}}),ae=class extends U.handlers.BaseHandler{static{e(this,"ConsoleHandler")}format(n){try{let s=JSON.parse(n.msg);return s.level=n.levelName,s.timestamp||(s.timestamp=n.datetime),delete s.hostname,we(s)}catch{return we({level:n.levelName,timestamp:n.datetime,msg:n.msg})}}log(n){console.log(n)}};await U.setup({handlers:{console:new ae("DEBUG")},loggers:{default:{level:"DEBUG",handlers:["console"]}}});var ve=class{static{e(this,"DefaultConsoleAdapter")}debug(...n){n.forEach(s=>{console.debug(JSON.stringify(s))})}info(...n){n.forEach(s=>{console.info(JSON.stringify(s))})}log(...n){n.forEach(s=>{console.log(JSON.stringify(s))})}warn(...n){n.forEach(s=>{console.warn(JSON.stringify(s))})}error(...n){n.forEach(s=>{console.error(JSON.stringify(s))})}},be=class{static{e(this,"LocalConsoleAdapter")}debug(...n){n.forEach(s=>{U.debug(s)})}info(...n){n.forEach(s=>{U.info(s)})}log(...n){n.forEach(s=>{U.info(s)})}warn(...n){n.forEach(s=>{U.warning(s)})}error(...n){n.forEach(s=>{U.error(s)})}},st=new ve,Te=new be;var tr="system-logger";globalThis.__ZUPLO_SERVICE_PROVIDER&&globalThis.__ZUPLO_SERVICE_PROVIDER.addService(tr,{logger:Te,captureUserLogs:!0});export{tr as SYSTEM_LOGGER};
